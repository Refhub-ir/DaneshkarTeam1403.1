@model Refhub_Ir.Models.Books.BookDetailsVM

<section class="content">
    <div class="container">
        <h1>@Model.Title</h1>
        @if (Model.BookAuthors?.Any() == true)
        {
            @string.Join(", ", Model.BookAuthors.Select(a => a.Author?.FullName ?? "ناشناس"))
        }
        @if (Model.BookKeywords?.Any() == true)
        {
            @string.Join(", ", Model.BookKeywords.Select(k => k.Keyword?.Word ?? "بدون کلیدواژه"))
        }
        <p><strong>کتاب‌های مرتبط:</strong></p>
        <ul>
            @foreach (var relatedBook in Model.RelatedTo)
            {
                <li>@relatedBook.RelatedBook.Title</li>
            }
        </ul>

        <hr />

        <h3>دانلود فایل‌ها</h3>
        @if (User.Identity.IsAuthenticated)
        {
            <div>
                @if (!string.IsNullOrEmpty(Model.FilePath))
                {
                    <a href="@Url.Content(Model.FilePath)" class="btn btn-primary">دانلود فایل اصلی کتاب</a>
                }
                else
                {
                    <p class="text-warning">فایل اصلی کتاب در دسترس نیست.</p>
                }
            </div>
            <div>
                @if (Model.RelatedTo.Any())
                {
                    <h4>فایل‌های مرتبط:</h4>
                    <ul>
                        @foreach (var relatedBook in Model.RelatedTo)
                        {
                            <li>
                                <a href="@Url.Content(relatedBook.RelatedBook.FilePath)" class="btn btn-secondary">
                                    دانلود فایل: @relatedBook.RelatedBook.Title
                                </a>
                            </li>
                        }
                    </ul>
                }
            </div>
        }
        else
        {
            <p class="text-danger">برای دانلود فایل‌ها، لطفاً وارد شوید.</p>
        }
    </div>
</section>